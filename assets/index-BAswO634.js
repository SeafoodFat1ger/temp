import{j as R,c,d as L,k as V,i as m,E as G,G as ge,n as p,T as Z,S as W,p as q,v as J,A as Q,I as Ce,L as ke,F as Ie,m as _,H as Se,U as Oe,V as we,r as be,W as ee,g as te}from"./index-BXgsGGBr.js";import{e as O,c as D,a3 as xe,n as I,l as w,x as pe,w as $,t as x,s as E,a4 as K,d as Pe,a5 as Te,p as ne,f as oe,g as ze,k as j,a6 as Be,H as Ae,I as ae,z as _e,A as Ee,K as Le,i as De}from"./index-D5UzUt9W.js";import{c as Ne}from"./interceptor-B_IeSHt0.js";function se(e){const t=R();t&&O(t.proxy,e)}let Me=2e3;const Re=()=>++Me,[$e,z]=D("loading"),je=Array(12).fill(null).map((e,t)=>c("i",{class:z("line",String(t+1))},null)),Fe=c("svg",{class:z("circular"),viewBox:"25 25 50 50"},[c("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),Ke={size:I,type:w("circular"),color:String,vertical:Boolean,textSize:I,textColor:String};var Ue=L({name:$e,props:Ke,setup(e,{slots:t}){const n=V(()=>O({color:e.color},xe(e.size))),l=()=>{const s=e.type==="spinner"?je:Fe;return c("span",{class:z("spinner",e.type),style:n.value},[t.icon?t.icon():s])},o=()=>{var s;if(t.default)return c("span",{class:z("text"),style:{fontSize:pe(e.textSize),color:(s=e.textColor)!=null?s:e.color}},[t.default()])};return()=>{const{type:s,vertical:a}=e;return c("div",{class:z([s,{vertical:a}]),"aria-live":"polite","aria-busy":!0},[l(),o()])}}});const Ye=$(Ue),le={show:Boolean,zIndex:I,overlay:x,duration:I,teleport:[String,Object],lockScroll:x,lazyRender:x,beforeClose:Function,overlayStyle:Object,overlayClass:E,transitionAppear:Boolean,closeOnClickOverlay:x},kt=Object.keys(le);function He(e,t){return e>t?"horizontal":t>e?"vertical":""}function Xe(){const e=m(0),t=m(0),n=m(0),l=m(0),o=m(0),s=m(0),a=m(""),i=m(!0),h=()=>a.value==="vertical",y=()=>a.value==="horizontal",f=()=>{n.value=0,l.value=0,o.value=0,s.value=0,a.value="",i.value=!0};return{move:v=>{const g=v.touches[0];n.value=(g.clientX<0?0:g.clientX)-e.value,l.value=g.clientY-t.value,o.value=Math.abs(n.value),s.value=Math.abs(l.value);const C=10;(!a.value||o.value<C&&s.value<C)&&(a.value=He(o.value,s.value)),i.value&&(o.value>K||s.value>K)&&(i.value=!1)},start:v=>{f(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:f,startX:e,startY:t,deltaX:n,deltaY:l,offsetX:o,offsetY:s,direction:a,isVertical:h,isHorizontal:y,isTap:i}}let P=0;const U="van-overflow-hidden";function Ve(e,t){const n=Xe(),l="01",o="10",s=f=>{n.move(f);const r=n.deltaY.value>0?o:l,d=Te(f.target,e.value),{scrollHeight:v,offsetHeight:g,scrollTop:C}=d;let k="11";C===0?k=g>=v?"00":"01":C+g>=v&&(k="10"),k!=="11"&&n.isVertical()&&!(parseInt(k,2)&parseInt(r,2))&&ne(f,!0)},a=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",s,{passive:!1}),P||document.body.classList.add(U),P++},i=()=>{P&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",s),P--,P||document.body.classList.remove(U))},h=()=>t()&&a(),y=()=>t()&&i();Pe(h),G(y),ge(y),p(t,f=>{f?a():i()})}function ce(e){const t=m(!1);return p(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const Y=()=>{var e;const{scopeId:t}=((e=R())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[Ge,Ze]=D("overlay"),We={show:Boolean,zIndex:I,duration:I,className:E,lockScroll:x,lazyRender:x,customStyle:Object,teleport:[String,Object]};var qe=L({name:Ge,props:We,setup(e,{slots:t}){const n=m(),l=ce(()=>e.show||!e.lazyRender),o=a=>{e.lockScroll&&ne(a,!0)},s=l(()=>{var a;const i=O(ze(e.zIndex),e.customStyle);return j(e.duration)&&(i.animationDuration=`${e.duration}s`),q(c("div",{ref:n,style:i,class:[Ze(),e.className]},[(a=t.default)==null?void 0:a.call(t)]),[[J,e.show]])});return oe("touchmove",o,{target:n}),()=>{const a=c(Z,{name:"van-fade",appear:!0},{default:s});return e.teleport?c(W,{to:e.teleport},{default:()=>[a]}):a}}});const Je=$(qe),Qe=O({},le,{round:Boolean,position:w("center"),closeIcon:w("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:w("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[et,H]=D("popup");var tt=L({name:et,inheritAttrs:!1,props:Qe,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:l}){let o,s;const a=m(),i=m(),h=ce(()=>e.show||!e.lazyRender),y=V(()=>{const u={zIndex:a.value};if(j(e.duration)){const S=e.position==="center"?"animationDuration":"transitionDuration";u[S]=`${e.duration}s`}return u}),f=()=>{o||(o=!0,a.value=e.zIndex!==void 0?+e.zIndex:Re(),t("open"))},r=()=>{o&&Ne(e.beforeClose,{done(){o=!1,t("close"),t("update:show",!1)}})},d=u=>{t("clickOverlay",u),e.closeOnClickOverlay&&r()},v=()=>{if(e.overlay)return c(Je,_({show:e.show,class:e.overlayClass,zIndex:a.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},Y(),{onClick:d}),{default:l["overlay-content"]})},g=u=>{t("clickCloseIcon",u),r()},C=()=>{if(e.closeable)return c(ae,{role:"button",tabindex:0,name:e.closeIcon,class:[H("close-icon",e.closeIconPosition),Ae],classPrefix:e.iconPrefix,onClick:g},null)};let k;const fe=()=>{k&&clearTimeout(k),k=setTimeout(()=>{t("opened")})},ve=()=>t("closed"),me=u=>t("keydown",u),ye=h(()=>{var u;const{round:S,position:B,safeAreaInsetTop:M,safeAreaInsetBottom:he}=e;return q(c("div",_({ref:i,style:y.value,role:"dialog",tabindex:0,class:[H({round:S,[B]:B}),{"van-safe-area-top":M,"van-safe-area-bottom":he}],onKeydown:me},n,Y()),[(u=l.default)==null?void 0:u.call(l),C()]),[[J,e.show]])}),F=()=>{const{position:u,transition:S,transitionAppear:B}=e,M=u==="center"?"van-fade":`van-popup-slide-${u}`;return c(Z,{name:S||M,appear:B,onAfterEnter:fe,onAfterLeave:ve},{default:ye})};return p(()=>e.show,u=>{u&&!o&&(f(),n.tabindex===0&&Se(()=>{var S;(S=i.value)==null||S.focus()})),!u&&o&&(o=!1,t("close"))}),se({popupRef:i}),Ve(i,()=>e.show&&e.lockScroll),oe("popstate",()=>{e.closeOnPopstate&&(r(),s=!1)}),Q(()=>{e.show&&f()}),Ce(()=>{s&&(t("update:show",!0),s=!1)}),G(()=>{e.show&&e.teleport&&(r(),s=!0)}),ke(Be,()=>e.show),()=>e.teleport?c(W,{to:e.teleport},{default:()=>[v(),F()]}):c(Ie,null,[v(),F()])}});const nt=$(tt);let T=0;function ot(e){e?(T||document.body.classList.add("van-toast--unclickable"),T++):T&&(T--,T||document.body.classList.remove("van-toast--unclickable"))}const[at,b]=D("toast"),st=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],lt={icon:String,show:Boolean,type:w("text"),overlay:Boolean,message:I,iconSize:I,duration:Ee(2e3),position:w("middle"),teleport:[String,Object],wordBreak:String,className:E,iconPrefix:String,transition:w("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:E,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:I};var ct=L({name:at,props:lt,emits:["update:show"],setup(e,{emit:t,slots:n}){let l,o=!1;const s=()=>{const r=e.show&&e.forbidClick;o!==r&&(o=r,ot(o))},a=r=>t("update:show",r),i=()=>{e.closeOnClick&&a(!1)},h=()=>clearTimeout(l),y=()=>{const{icon:r,type:d,iconSize:v,iconPrefix:g,loadingType:C}=e;if(r||d==="success"||d==="fail")return c(ae,{name:r||d,size:v,class:b("icon"),classPrefix:g},null);if(d==="loading")return c(Ye,{class:b("loading"),size:v,type:C},null)},f=()=>{const{type:r,message:d}=e;if(n.message)return c("div",{class:b("text")},[n.message()]);if(j(d)&&d!=="")return r==="html"?c("div",{key:0,class:b("text"),innerHTML:String(d)},null):c("div",{class:b("text")},[d])};return p(()=>[e.show,e.forbidClick],s),p(()=>[e.show,e.type,e.message,e.duration],()=>{h(),e.show&&e.duration>0&&(l=setTimeout(()=>{a(!1)},e.duration))}),Q(s),Oe(s),()=>c(nt,_({class:[b([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:i,onClosed:h,"onUpdate:show":a},_e(e,st)),{default:()=>[y(),f()]})}});function it(){const e=be({show:!1}),t=o=>{e.show=o},n=o=>{O(e,o,{transitionAppear:!0}),t(!0)},l=()=>t(!1);return se({open:n,close:l,toggle:t}),{open:n,close:l,state:e,toggle:t}}function rt(e){const t=we(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}const ut={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let A=[],dt=!1,X=O({},ut);const ft=new Map;function ie(e){return De(e)?e:{message:e}}function vt(){const{instance:e,unmount:t}=rt({setup(){const n=m(""),{open:l,state:o,close:s,toggle:a}=it(),i=()=>{},h=()=>c(ct,_(o,{onClosed:i,"onUpdate:show":a}),null);return p(n,y=>{o.message=y}),R().render=h,{open:l,close:s,message:n}}});return e}function mt(){if(!A.length||dt){const e=vt();A.push(e)}return A[A.length-1]}function yt(e={}){if(!Le)return{};const t=mt(),n=ie(e);return t.open(O({},X,ft.get(n.type||X.type),n)),t}const re=e=>t=>yt(O({type:e},ie(t))),It=re("success"),N=re("fail"),ue=()=>N("发生了一些错误，请联系管理员"),de=e=>N(e);function St(e,t,n,l="json",o=de,s=ue){ee.post(e,t,{}).then(({data:a})=>{a.code===401?(te.push("/"),N("请重新登录")):a.code==200?n(a.message,a.data):o(a.message,a.code)}).catch(s)}function Ot(e,t,n=de,l=ue){ee.get(e,{}).then(({data:o})=>{o.code===401?(te.push("/"),N("请重新登录")):o.code==200?t(o.message,o.data):n(o.message,o.code)}).catch(l)}export{Ye as L,nt as P,N as a,yt as b,Y as c,Xe as d,le as e,kt as f,Ot as g,St as p,It as s,se as u};
