import{u as B,i as n,A as C,a as d,b as i,s as p,F as x,q as k,B as A,o as l,C as F}from"./index-BXgsGGBr.js";import{i as f}from"./index-DFpWVYxE.js";import{p as u,b as N}from"./index-BAswO634.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D5UzUt9W.js";import"./interceptor-B_IeSHt0.js";const S={class:"profile-page"},T={class:"user-info"},E={class:"user-name"},J={class:"icon-row"},M=["onClick"],P={class:"icon"},L={__name:"profile",setup(U){const c=B(),h=F(),v=n([{name:"å½“å‰å€Ÿé˜…",icon:"ğŸ“–",path:"/home/profile_BooksList"},{name:"æ™ºèƒ½é—®ç­”",icon:"ğŸ¤–",path:"/home/hot"},{name:"å€Ÿé˜…ç»Ÿè®¡",icon:"ğŸ“Š",path:"/home/profile_History"},{name:"ä¸ªäººä¿¡æ¯",icon:"ğŸ‘¤",path:"/home/profile_info"}]),y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];async function _(){const t=n([]);return new Promise((e,a)=>{u("/api//profile/timeData/",{userId:c.auth.user.userId},(s,o)=>{s==="æ“ä½œæˆåŠŸ"?(t.value=o.timeData,e(t)):a("Failed to fetch type data")})})}async function b(){const t=await _(),e=document.getElementById("borrow-time-chart"),a=f(e),s={title:{text:"å€Ÿé˜…æ—¶é—´åˆ†å¸ƒ",left:"center"},xAxis:{type:"category",data:t.value.map(o=>y[o.month-1])},yAxis:{type:"value"},series:[{data:t.value.map(o=>o.borrowed),type:"bar",color:"rgba(115,192,222,0.78)"}]};a.setOption(s)}async function w(){const t=n([]);return new Promise((e,a)=>{u("/api/profile/typeData/",{userId:c.auth.user.userId},(s,o)=>{s==="æ“ä½œæˆåŠŸ"?(t.value=o.typeData,e(t)):a("Failed to fetch type data")})})}async function g(){const t=await w();t.value=t.value.filter(r=>r.borrowedNum>0);const e=document.getElementById("borrow-type-chart"),a=f(e),s=t.value.map(r=>({name:r.typename,value:r.proportion})),o={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:t.value.map(r=>r.typename)},series:[{name:"å€Ÿé˜…ç±»å‹",type:"pie",radius:"50%",data:s,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};a.setOption(o)}const m=n([]);async function D(){u("/api/profile/getUserInfo/",{userId:c.auth.user.userId},(t,e)=>{m.value=e.userInfo})}function I(t){t?h.push(t):N("åŠŸèƒ½å¼€å‘ä¸­")}return C(()=>{D(),g(),b()}),(t,e)=>(l(),d("div",S,[i("div",T,[e[0]||(e[0]=i("div",{class:"user-avatar"},"ğŸ‘¤",-1)),i("p",E,p(m.value.username),1)]),i("div",J,[(l(!0),d(x,null,k(v.value,(a,s)=>(l(),d("div",{key:s,class:"icon-item",onClick:o=>I(a.path)},[i("div",P,p(a.icon),1),i("p",null,p(a.name),1)],8,M))),128))]),e[1]||(e[1]=A('<div class="data-section" data-v-891bdc14><p class="section-title" data-v-891bdc14>å€Ÿé˜…æ•°æ®</p><div id="borrow-time-chart" class="chart-container" data-v-891bdc14></div><div id="borrow-type-chart" class="chart-container" data-v-891bdc14></div></div><div class="relationship-section" data-v-891bdc14><p class="section-title" data-v-891bdc14>æˆ‘ä¸å›¾ä¹¦é¦†</p><p data-v-891bdc14>è¿™é‡Œæ˜¯ä¸€äº›å…³äºç”¨æˆ·å’Œå›¾ä¹¦é¦†çš„æ–‡å­—æè¿°ã€‚</p></div>',2))]))}},$=O(L,[["__scopeId","data-v-891bdc14"]]);export{$ as default};
